<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Documentação Nérus O2</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <p><a id="intro"> 1. O que é o Nérus O2?</a></p><br> Nérus O2 é um conjunto de ferramentas e processos que permitem a integração das lojas físicas com a venda digital, tanto em sites próprios quanto em marketplaces.
    <br> O nome O2 vem da junção do varejo "Off-line"(físico) e "On-line"(digital).<br> Por meio do Nérus O2, o varejista consegue, de uma forma bastante simples, integrar todos os processos de atualização de cadastros, preços, estoques e vendas, não
    importando se a venda foi feita na loja física ou na internet.
    <br>A venda digital adiciona novas possibilidades de venda para o varejo físico, mas traz a reboque a necessidade de novos controles.<br> A gestão de estoque, por exemplo, passa a ser ainda mais importante do que na venda física sozinha, pois um mesmo
    produto pode ser vendido em diferentes canais ao mesmo tempo.<br> E assim que a mercadoria é vendida, o estoque deve ser baixado em todos os canais simultaneamente, de tal forma que o consumidor não consiga comprar uma mercadoria que não poderá ser
    entregue.
    <br> Isso é muito importante para que a empresa não perca relevância - lojas on-line com problemas de venda ou entrega perdem pontuação nos marketplaces, e fica mais difícil encontrá-las nas pesquisas, o que consequentemente se reflete em diminuição
    dos pedidos.<br> A venda em marketplaces, especificamente, potencializa os canais de venda, mas também adiciona a necessidade de mais um grau de organização e controle dos processos. Isso porque cada plataforma possui suas próprias características
    de publicação de anúncios, regras diferentes para categorização de produtos, um conjunto próprio de interfaces de comunicação e fluxos particulares de emissão de notas fiscais e etiquetas.<br> E é aí que entra a facilidade proposta pelo Nérus O2:
    por meio de dados e processos centralizados, todas as particularidades de cada canal - marketplace ou site próprio - são tratadas de forma transparente para o lojista. Ou seja, para a empresa que utiliza o Nérus O2, não faz diferença se uma venda
    foi feita no Mercado Livre, Americanas.com ou no site próprio, já que isso é tratado de forma centralizada, e integrada com a retaguarda de forma automática e transparente.
    <p><a id="fluxoProcesso">2. Fluxo do Processo</a></p> A imagem abaixo mostra os pontos principais dos processos tratados pelo Nérus O2.<br> A imagem mostra a integração que o Nérus O2 faz com os diferentes processos da venda digital, acoplando de forma
    suave e transparente aos processos já existentes relativos à venda física.
    <br> Os processos que Nérus O2 é responsável ou atua diretamente estão descritos a seguir:<br> Cadastro, Preços e Estoque<br> O Nérus O2 faz toda a recepção dos dados de produtos, preços e estoque da empresa.<br> Os produtos são então "enriquecidos",
    de tal forma que possam ser vendidos de forma mais assertiva nos canais digitais.
    <br> Isso inclui a descrição com bastante detalhamento, novas fotos, categorização e a inclusão de "tags" para facilitar a localização pelos mecanismos de buscas (Google, por exemplo).<br> Gestão de Anúncios A venda de produtos em marketplaces ocorre
    por meio de "anúncios".<br> Algumas plataformas permitem que sejam criados anúncios diferentes com preços diferentes para produtos iguais.<br> Com isso, é preciso fazer todo um controle desses anúncios, o que inclui "montagem" do anúncio (definição
    do produto, preço, estoque e fotos), a publicação simultânea em diferentes plataformas, até a "pausa" do anúncio (produto não pode ser mais vendido nas condições publicadas), de forma manual ou automática.<br> Centralização e Integração de Pedidos
    Todos os pedidos (vendas) efetuados nas diversas plataformas - tanto site próprio quanto marketplaces - são centralizados em um único painel, e integrados de forma automática com ERP, de forma periódica.<br> Isso permite uma gestão centralizada e
    por canal. E, com a integração, um pedido efetuado em qualquer local fica automaticamente disponível para seguir o fluxo de separação, emissão de documento fiscal, embalagem e envio.
    <p><a id="vendasDropShipping">3. Vendas por encomenda e dropshipping</a></p>
    Vendas por encomenda representam um modelo bastante interessante nos canais digitais.<br> São muito semelhantes ao modelo de dropshipping onde, em ambos os casos, o varejista efetua uma venda cujo estoque está em poder do fornecedor.<br> Isso quer
    dizer que o lojista não possui a mercadoria no momento da venda.<br> Umas das principais vantagens nesse processo é que a empresa não precisa ter em estoque todo o catálogo dos fornecedores.
    <br> Com isso, a oferta de produtos pode ser muito maior que um mix normal de produtos, sem inclusive investir recursos em mercadorias com pouco ou nenhum giro.<br> A diferença entre a venda por encomenda e o dropshipping está basicamente na entrega
    da mercadoria e nos processos correlatos.<br> No caso da venda por encomenda, assim que ela ocorre é feita uma encomenda para o fornecedor.<br> Daí para frente, o processo segue o fluxo normal de uma operação de varejo.
    <br> A vantagem é que a mercadoria que chegará ao estabelecimento já está vendida.<br> Já no caso do dropshipping, todo o processamento da venda, que inclui a expedição e especialmente a entrega, ficam a cargo do fornecedor.<br> Para a lojista, essa
    modalidade possui alguns atrativos interessantes: o custo total da operação tende a ser muito mais baixo, já que não há a administração do estoque físico nem qualquer questão relacionada à entrega.<br> Por outro lado, existem grandes riscos: o fornecimento
    e o envio dos produtos podem se tornar um problema, dependendo da localidade e disponibilidade do item.
    <br> Há que se pensar ainda em dificuldades muito comuns na integração entre os diferentes sistemas do lojista e do fornecedor, o que pode acarretar em sérios transtornos na operação como um todo.<br> Daí a importância de se confiar em produtos com
    um alto nível de serviço que, em última instância, não irá comprometer a credibilidade do lojista.<br> O Nérus O2 já está preparado tanto para a venda por encomenda quanto para o dropshipping.<br> Para ambos os modelos, existe um fator interessante:
    o produto não precisa previamente existir no Nérus ERP para que seja vendido.<br> O produto que será vendido diretamente do estoque do fornecedor é inserido apenas no Painel do Nérus O2. No momento da venda digital, o produto é inserido automaticamente
    no Nérus ERP, assim como é gerado um pedido de compra para o fornecedor, tudo isso de forma transparente e automática.<br> A vantagem disso é que os produtos que só serão vendidos on-line e com estoque de terceiros não poluem a base de dados do ERP.<br>    Com efeito, é possível importar catálogos de vários fornecedores e disponibilizar essas mercadorias para venda na internet, sem prejudicar a operação das lojas.
    <p><a id="integracaoERP"> 4. Integração com Nérus ERP </a></p> A integração com o Nérus ERP ocorre basicamente em 3 momentos:<br> 1. Envio para o Nérus O2 de dados de produtos, preços, estoque e fotos, para publicação de anúncios e vendas no site e marketplaces.<br>    (sentido da integração: ERP => O2)<br> Para cada alteração dos dados de um produto - preço, estoque ou foto - é gerada uma "fila" de produtos a serem atualizados no O2.<br> As ferramentas de integração então consomem essas filas automaticamente, fazendo
    com que a atualização seja refletida no O2 em poucos segundos.<br> Esse processo é transparente para o usuário, já que não é necessária nenhuma ação adicional.<br> 2. Recebimento no Nérus ERP dos pedidos confirmados (vendas) efetuados nos diferentes
    canais.
    <br> (sentido da integração: O2 => ERP)<br> Cada pedido recebido no Nérus ERP possui a identificação do canal em que a venda foi efetuada, seguindo a seguinte tabela:<br> 1-E-Commerce (site próprio)<br> 2-Mercado Livre<br> 3-Magalu<br> 4-Submarino<br>    5-Americanas.com<br> 6-Shoptime
    <br> 7-Extra<br> 8-Pontofrio.com<br> 9-Casas Bahia.com<br> 10-Discount.com
    <br> 11-Amazon<br> 12-Monetizze<br> 13-Groupon<br> 14-Olist
    <br> O tipo de pagamento das vendas em site próprio (canal = 1) será Cartão ou Duplicata, de acordo com o que o cliente pagou, ou mesmo um Convênio específico, caso o site próprio faça um acordo com algum gateway de pagamento ou fornecedor único (Mercado
    Pago, por exemplo).<br> Para as vendas em marketplace (canal maior que 1), será gerada uma venda em Convênio.<br> Consequentemente, será preciso existir uma operadora de Convênio para cada marketplace utilizado.<br> A forma de se fazer isso no Nérus
    ERP será detalhada mais adiante.<br> Os pedidos enviados pelo Nérus O2 são integrados automaticamente aos processos de entrega existentes no Nérus ERP, que incluem romaneios e geração de cargas.
    <br> Cada pedido dá origem a um romaneio de entrega e ficam disponíveis na aba "Pendentes" dos romaneios.<br> Nesse momento ocorre o processo de picking (separação da mercadoria) e packing, que normalmente conta com os seguintes processos:<br> - Geração
    de cargas incluindo todos os pedidos separados por canal (vendas do site próprio, Mercado Livre, Americanas.com, etc), na aba Pendentes;<br> - Listagem para separação de mercadoria de todos os pedidos de uma carga, na aba Cargas;<br> - Emissão das
    Notas Fiscais de uma Carga, na aba Cargas.<br> 3. Envio para o Nérus O2 das Notas Fiscais (XMLs) relativos aos pedidos faturados de cada canal.<br> (sentido da integração: ERP => O2) Após a emissão das notas fiscais dos pedidos vendidos, é importante
    que o XML dessas notas sejam enviados para os marketplaces, pois alguns deles só geram a etiqueta de entrega após o recebimento das notas fiscais.
    <br> Mais uma vez, esse processo é transparente para o usuário: o Nérus O2 consulta, periodicamente e de forma rápida, quais pedidos já tiveram nota fiscal emitida. Para esses pedidos, o XML é enviado para o marketplace correspondente, e as etiquetas
    de entrega ficam disponíveis para impressão e colocação na embalagem, dando continuidade ao processo de packing e despacho da mercadoria.<br>
    <p><a id="preRequisitos">5. Pré-Requisitos</a></p> 1 - Definição do estoque para as vendas na internet Existem diferentes formas de se definir qual será o estoque utilizado nas vendas digitais, tanto no site próprio quanto nos marketplaces. Algumas empresas
    mais estruturadas possuem um CNPJ específico para a operação digital.<br> Outras empresas utilizam um CNPJ já existente, mas separam uma área de estoque específica para as vendas digitais.<br> E algumas redes de lojas, em uma visão bem integrada de
    canais (omnichannel), enviam o estoque de cada loja para os canais, de forma a permitir a venda na internet com retira na loja (conceito conhecido como BOPIS - Buy On Line & Pickup In Store, ou seja, compra on-line e retira na loja).<br> Cada modelo
    escolhido possui um conjunto de processos que deverão ser executados para que a operação possa estar corretamente integrada aos processos da empresa.
    <br> Uma das formas mais fáceis de iniciar é separar os estoques a partir da criação de uma área de estoque, mas implica em ter todas as lojas também trabalhando com o recurso de área de estoque.<br> Portanto, é preciso avaliar cada opção de acordo
    com o grau de maturidade de processos da empresa e os objetivos de curto, médio e longo prazo com a venda on-line.<br> 2 - KIT de Produtos É muito comum a venda de KITs de produtos em marketplaces, especialmente para alguns setores (ferramentas e
    autopeças, por exemplo).<br> Nesses casos, o anúncio é feito com base no KIT, mas a nota fiscal e todo o controle de estoque ocorre nos itens que compõem o KIT.<br> Para empresas que utilizam KIT, portanto, é fundamental conhecer os processos que
    envolvem KIT dentro do Nérus ERP.<br> 3 - Precificação Toda a integração de preços com o Nérus O2 é feita a partir da Precificação do Nérus ERP.<br> Portanto, é imprescindível que a empresa esteja utilizando corretamente este módulo, pois é de lá
    que serão enviados todos os preços-base para que sejam criados os anúncios.<br> 4 - Vertical Web Conforme mencionado anteriormente, os pedidos enviados pelo Nérus O2 são integrados automaticamente aos processos de entrega existentes no Nérus ERP,
    que incluem romaneios e geração de cargas.<br> Os novos recursos para as vendas on-line<br> - geração de cargas por canal, impressão de todos os pedidos de uma carga, integração dos XMLs das notas emitidas<br> - estão contemplados dentro do recurso
    conhecido como "Vertical Web" dentro do Nérus ERP.<br> Esse recurso, portanto, deverá estar habilitado na Configuração Geral do Nérus ERP.<br> Importante ressaltar que na Vertical Web o pedido é inserido como reservado na aba pendente e não vendido
    como o convencional.
    <br> Seu status somente será alterado para vendido após seu faturamento.
    <br> 5 - Integração para XML das Notas Emitidas Para que as notas fiscais emitidas sejam integradas com o Nérus O2, é preciso verificar a forma como essas notas estão sendo emitidas.<br> Para clientes Nérus ERP que utilizam a emissão notas via NDD,
    basta acionar o Suporte da Nérus para que seja aberto um chamado junto à NDD.<br> Com isso, será possível utilizar um serviço da própria NDD que retornar o XML de uma nota emitida.<br> Para clientes que usam Nérus e-Doc, a integração é transparente,
    não sendo necessária nenhuma ação ou configuração adicional.<br> 6 - Binários do Nérus ERP em "camada alta" As APIs de integração com Nérus O2 só funcionam com versões mais recentes de Linux, o que comumente é chamado de "camada alta" ou "plataforma
    alta".
    <br> Exemplos de distribuições que funcionam são CentOS 7, Debian 8 ou AWS Linux.<br> Em caso de dúvidas, consulte o Suporte da Nérus.<br> 7 - Grades Para empresas que trabalham com grades - também conhecidas pelo nome de “variações” - é preciso que
    sejam feitas algumas conferências e eventuais alterações, de modo que a integração possa funcionar corretamente nos diferentes canais digitais.<br> Isso porque a maioria dos canais oferece um bom serviço para o consumidor ao colocar, em um único anúncio,
    o mesmo produto com todas as variações, tornando muito simples o processo de escolha da combinação de grades (variações) desejada.<br> Pode-se tomar como exemplo o anúncio abaixo, do Mercado Livre.<br> Nessa imagem é possível ver que, com apenas 2
    cliques do mouse, o usuário pode escolher o tamanho e a cor do produto. Para a grade de cor, a foto correspondente é carregada para ficar coerente com a cor escolhida (e, para esse caso, não faz sentido ter fotos diferentes se apenas a numeração foi
    alterada).
    <br> Do lado do Nérus, é enviado para o canal toda a “matriz de grade”, seja para o produto que possui apenas uma grade (Voltagem, por exemplo - 110V ou 220V) ou duas grades (Cor e Tamanho, como no exemplo da imagem acima).<br> Ocorre que, para que
    os canais possam montar corretamente os anúncios, é preciso que as grades e suas descrições possuam determinados padrões pré-definidos, que se referem ao nome da grade (variação) e ao valor da grade (descrição da variação).
    <br> Para o nome da grade, deve-se adotar o seguinte no Nérus, campo “Descrição da Grade”:<br> ⦁ Grade de cor: a grade deve ser cadastrada com a palavra COR <br> ⦁ Grade de tamanho: a grade deve ser cadastrada com TAMANHO<br> ⦁ Grade de voltagem:
    a grade deve ser cadastrada com VOLTAGEM<br> ⦁ Para outras grades envolvem desenhos e/ou estampas, a grade deve ser cadastrada com a palavra ESTAMPA. <br>⦁ Para qualquer outra grade que não se encaixe nos exemplos acima, entrar em contato com a equipe
    do Nérus O2, para que seja orientado qual a descrição a ser informada.<br> Para os valores dentro de cada grade (exemplo: “Preto”, “Azul”, “32”, “110V”, etc) deve-se usar a descrição completa do valor de grade, que pode ser informada em Configuração
    da Empresa, Grades, F3-descrição do valor de grade.<br> Isso porque normalmente, no Nérus ERP, os valores são abreviados, como por exemplo:<br> Vermelho = VERM, Azul Turquesa = AZLT, e assim por diante.<br> Nos canais digitais essas abreviações não
    são reconhecidas, logo, devem ser usados os termos esperados por cada canal.<br> Vale, portanto, consultar a documentação de cada um deles para verificar os valores que devem ser informados, já que a API do Nérus irá buscar os valores a partir desses
    locais descritos acima.<br>
    <p><a id="webhook">6. Webhook</a></p> Webhook é uma forma de recebimento de informações, que são passadas quando um evento acontece.<br> Dessa forma, o webhook na prática, é a forma de receber informações entre dois sistemas de uma forma passiva.<br>    O Nerus O2 utiliza um webhook para manter o site sempre atualizado conforme mudanças acontecem no Saci.<br> Essas mudanças podem ser alterações em preços de produtos, ou movimentações de estoque.<br> O webhook é um projeto separado da api, mas com
    a utilização do docker, conseguimos subir os dois projetos ao mesmo tempo e configurá-los apenas com variáveis de ambientes inseridas no arquivo .yml.
    <p><a id="docTecnica">7. Documentação Técnica</a></p> 7.1 Instalação e atualização:
    <br> Nérus O2 API e Docker A API do Nérus O2 é utilizada a partir de um contêiner do docker.<br> De forma bem simplificada, docker é uma ferramenta que permite o empacotamento e execução de aplicações de forma isolada, utilizando contêineres.<br>    A grande vantagem de se usar essa tecnologia é que tudo que a API do Nérus O2 precisa para funcionar está dentro deste contêiner, facilitando enormemente a distribuição, instalação e atualização da API.<br> Portanto, será preciso instalar o docker
    para que possa ser feito o gerenciamento dos contêineres, que onde está a API do Nérus O2.<br> IMPORTANTE: a instalação do docker, containers e outras configurações do Nérus O2 são executadas pela equipe de Serviços da Nérus.<br> A documentação abaixo
    é uma referência para apoiar a própria equipe e outras empresas que já tenham experiência com dockers. O primeiro passo para que a API funcione é instalar 2 pacotes, docker e docker-compose.<br> Instalar o Docker e Docker-Compose:
    <br> Para distribuição Debian<br> apt-get install docker-ce
    <br> apt-get install docker-compose<br> Para distribuição CentOs
    <br> Instalar o Docker<br> curl -fsSL https://get.docker.com/ | sh<br> Instalar o Docker Compose a partir do binário no repositório GitHub do Docker.<br> Verifique a release atual e se necessário, atualize-a com o comando abaixo:
    <br> sudo curl -L "https://github.com/docker/compose/releases/download/1.23.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose<br> sudo cp /usr/local/bin/docker-compose /usr/bin/docker-compose<br> Em seguida, defina as permissões
    para tornar o binário executável:<br> sudo chmod +x /usr/local/bin/docker-compose
    <br> Após isto verifique as versões instaladas:
    <br> docker -v<br> Docker version 18.06.1-ce, build e68fc7a215d7133c34aa18e3b72b4a21fd0c6136
    <br> docker-compose -v<br> docker-compose version 1.24.0, build 0aa59064<br> Acrescentar um novo usuário administrador<br> Após a instalação, o serviço de ‘docker’ somente pode ser administrado pelo usuário root.<br> Porém é possível habilitar um
    usuário normal para realizar esta administração.<br> Para isso você precisa apenas digitar os seguinte comandos:<br> usermod -a -G docker eacadm<br> Em seguida digite:
    <br> sudo chmod 755 /var/run/docker.sock<br> Permitir acesso ao servidor de container’s da Nérus Com o serviço de docker instalado, será preciso agora baixar os contêineres, definindo também o caminho do servidor para qualquer nova atualização.<br>    O docker tem a preferência pelo acesso “https” - protocolo de comunicação criptografado - para baixar as imagens dos contêineres.<br> No caso da Nérus, o servidor de container’s somente permite o acesso via “http”, sem criptografia.<br> Com isso,
    será necessário informar ao serviço de docker a permissão de acesso “http” ao repositório de imagens.<br> Para executar os comandos abaixo, você deve ter acesso nível super usuário (root).<br> Siga para a pasta de configuração do ‘docker’:<br> cd
    /etc/docker
    <br> Se o arquivo ‘daemon.json’ não existir, crie-o:<br> touch daemon.json<br> Este arquivo é escrito em formato ‘json’, portanto, ‘cole’ as seguintes instruções abaixo:<br> {<br> "insecure-registries" : [ "docker.nerus.com.br:6080" ]<br> }<br> Reiniciar
    o serviço docker<br> Agora que já está tudo pronto para receber contêineres, basta apenas reiniciar o serviço de docker.<br> OBS: Será preciso acesso de superusuário - root):<br> Exemplo: sudo service docker restart<br> Baixar o arquivo com as variáveis
    para a API Nérus O2<br> É preciso que uma série de variáveis estejam definidas para que a API do Nérus O2 funcione, pois elas é que vão estabelecer todo o comportamento da API.<br> Na prática, é um conjunto de configurações, que vão desde IP do servidor
    do MySQL até o número da loja onde serão inseridos os pedidos efetuados on-line.<br> A Nérus já criou um arquivo padrão, que pode ser baixado do seguinte local:<br> >> Portal do Cliente<br> >> Acesso ao Suporte<br> >> Releases<br> >> Docker nerus-api.yml<br>    Copie esse arquivo para /opt/NerusO2/ (crie o diretório se não existir).<br> Segue a explicação das das variáveis a serem preenchidas neste arquivo.<br> Consulte o Suporte da Nérus para ajudar no preenchimento de todas as variáveis, se necessário.<br>    API: - PORT=3007 >> Porta de conexão a ser utilizada dentro do servidor(não alterar)<br> - SECRET=123456 >> não alterar
    <br> - LVL_LOG=FULL >> Nível de logs<br> - XML_PATH= >> não alterar <br>- DB_HOST=10.140.5.5 >> Host do banco de dados <br>- DB_PORT=3306 >> Porta do banco de dados
    <br>- DB_USER=root >> usuário do Banco <br>- DB_PASS= >> Senha do usuário do banco <br>- DB_NAME=sqldados >> nome do banco de dados <br>- DB_PARAM_NAME=sqlparam >> nome do banco de dados de parâmetros <br>- DB_PDV_NAME=slqpdv >> nome do banco pdv
    <br>- DB_HOST_LOG=10.140.5.5 >> ip do banco de logs <br>- DB_NAME_LOG=sqltmp >> nome do banco de dados de logs <br>- DB_USER_LOG=root >> usuário do banco de dados de logs <br>- DB_PASS_LOG= >> senha para o banco de dados de logs <br>- DB_PORT_LOG=3306
    >> porta de conexão ao banco de dados de logs <br>- EMPNO=20 >> funcionário default da venda <br>- PDVNO=433 >> número do pdv de faturamento <br>- REGIME_VERTICAL=1 >> flag que indica regime vertical <br>- USA_CONVENIO=1 >> indica uso de convênio
    para os tipos de pagamento em e-commerce <br>- USA_PDV_OFF=1 >> indica que o cliente usa também nosso produto de pdv off <br>- SANO=2 >> área de estoque reservado ao marketplace <br>- SANO_VERTICAL=500 >> área de estoque transitória para regime vertical
    <br>- SANO_CD=1 >> área de estoque de venda para regime vertical <br>- PROMOTYPE=1 >> define o tipo de promoção utilizada, caso tenha <br>- STORENO=2 >> loja da venda <br>- STORENO_PRECO=2 >> loja de precificação <br>- STORENO_CD=1 >> loja de entrega
    para regime vertical <br>- STK_STORES=1,2,3 >> lojas de estoque <br>- DROP_SHIPPING=1 >> flag que indica se utiliza drop shipping <br>- ENTREGA_FUTURA=1 >> flag que indica se se os pedidos funcionam com Entrega Futura <br>- DIAS_ENTREGA=1 >> indica
    a qte de dias entre data pedido e data entrega <br>- PRDUNNO=1 >> indica com qual unidade o drop shipping irá trabalhar <br>- CODIGO_CARTAO=33 >> número do método de pagamento cartão usado na venda
    <br>- CODIGO_BOLETO=2 >> número do método de pagamento duplicata usado na venda a boleto <br>- CODIGO_CONVENIO=1 >> número do método de pagamento convênio <br>- CODIGO_CHEQUE=3 >> número do método de pagamento cheque <br>- CODIGO_DEPOSITO=4 >> número
    do método de pagamento depósito <br>- NDD_USUARIO=XYZ_WS1 >> usuário usado na integração de xml NDD <br>- NDD_SENHA=XYZ_WS1 >> senha de usuário usado na conexão de integração com xml ndd <br>- NDD_CONEXAOID=1464 >> id de conexão da ndd <br>- USA_FRETE=1
    >> indica uso de frete no pedido e na simulação de pagamento <br>- INIBE_CADASTRO_DROPSHIPPING >> Bloqueia cadastro de produtos DropShipping. <br>- USA_PRECO_ATACADO >> Envia preço atacado como preço Promocional: nginx: <br>- ROUTE_IP=nerus_api_container_prod
    >> nome do container que sobe a imagem da api(fixo) <br>- ROUTE_PORT=3007 >> porta definida para o docker(não alterar) <br>- ROUTES=authenticate >> tipo de rota(não alterar) webhook: <br>- WORKER_LIMIT >> Define quantas threads irão trabalhar de modo
    síncrono <br>- STK_STORES=1,2 >> Define as lojas de estoque que serão analisadas pelo webhook <br>- STORENO_PRECO=2 >> Define a loja de precificação que será analisada pelo webhook <br>- INTERVAL_STK=30 >> Intervalo, em segundos, em que a verificação
    de estoque acontecerá <br>- INTERVAL_PRICE=30 >> Intervalo, em segundos, em que a verificação de preço acontecerá <br>- INTERVAL_ADD_INFO=50 >> Intervalo, em segundos, em que a verificação de inf. adic. acontecerá
    <br>- DB_HOST=10.140.5.5 >> Host do banco <br>- DB_PORT=3306 >> Porta do banco <br>- DB_USER=root >> Usuário do banco <br>- DB_PASS= >> Senha do banco <br>- DB_NAME=sqldados >> Nome da base <br>- DB_PDV_NAME=sqlpdv >> Nome da base de pdv <br>- DB_HOST_LOG=10.140.5.5
    >> Host do banco de log <br>- DB_NAME_LOG=sqltmp >> Nome da base de log <br>- DB_USER_LOG=root >> Usuário do banco de log <br>- DB_PASS_LOG= >> Senha do banco de log <br>- DB_PORT_LOG=3306 >> Porta do banco de log <br>- ENDPOINT_WEBHOOK >> Endpoint
    gerado pela venda.la<br> Baixar o contêiner que contém a API do Nérus O2 Após a edição do arquivo, alterando as variáveis de acordo com a necessidade da empresa, a API (que está no contêiner) deverá ser baixada do servidor da Nérus.<br> O comando
    abaixo faz exatamente isso, e também será executado sempre que houver uma atualização na API:<br> docker-compose -f nerus-api.yml pull <br>Deverá ser retornado algo do tipo:
    <br> docker-compose -f nerus-api.yml pull ou docker-compose -f nerus-api.yml pull -d(executa em background deixando o terminal livre)<br> Pulling nginx ... done<br> Pulling nerus_api ... done<br> Finalmente, basta ativar ("subir") o contêiner com
    o comando abaixo:<br> docker-compose -f nerus-api.yml up<br> Se todas as conexões retornarem sucesso, deverá ser mostrado algo como:<br> nginx_1 | ---------------------------------------
    <br> nginx_1 |<br> Executando nginx nerus_api_1 |<br> Verificacao de tabelas concluida!<br> nerus_api_1 | Configurações validadas com sucesso!<br> Inserir um usuário para o uso da API Nesse momento, a API estará praticamente pronta para uso, faltando
    apenas cadastrar um usuário que será o responsável por verificar se a conexão com a API é válida (questões de segurança).<br> Esse usuário deverá ser inserido diretamente no banco de dados utilizado pela empresa (normalmente 'sqldados').<br> Quando
    a API for chamada, os dados desse usuário serão utilizados para verificar a conexão, garantindo a segurança do processo.<br> Para inserir, basta definir nome, login e senha.<br> Exemplo:<br> nome = Wesley,
    <br> login = adm,
    <br> senha = 1234.<br> O comando então fica assim:<br> INSERT INTO sqldados.usersapi (name,login,password) VALUES ('Wesley', 'adm', MD5(SHA1('1234')));
    <br> OBS: a tabela “usersapi” será criada automaticamente na primeira vez que a API for inicializada. Para validar a conexão com a API a partir de uma máquina fora da rede, utilize o comando abaixo:<br> curl --location --request POST 'http://IP_API:PORTA_API/authenticate'
    \--header 'Content-Type: application/x-www-form-urlencoded' \--data-urlencode 'user=USER_API' \--data-urlencode 'password=PWD_API'<br> Onde: IP_API = IP da máquina onde foi instalada a API do cliente<br> PORTA_API = Porta configurada na api para o
    serviço NGINX na tag "- ports:" normalmente 3007
    <br> USER_API = Campo login da tabela usersapi<br> PWD_API = Campo password da tabela usersapi<br> A execução, em caso de sucesso, deve retornar algo parecido com:<br> {"auth":true,"token":"eyJhbGciO..."}
    <br> Atualização da API em caso liberação de nova versão<br> A atualização da API é bem simples e normalmente leva poucos segundos para ser executada.
    <br> Para isso, basta seguir os seguintes passos:<br> ⦁ Verifique se a API está em execução e capture o “ID”, executando o seguinte comando:<br> docker ps<br> Caso a API esteja ativa será retornado algo como:<br> CONTAINER_ID IMAGE COMMAND CREATED
    STATUS PORTS NAMES<br> 937ebc66a2d1 docker "/etc/nginx/" 7 days ago Up 2 sec 0.0.0.0:3007<br> neruso2_nginx_1 f8ea7aea0c0b docker "dockers…" 7 days ago Up 7 sec 0.0.0.0:32768 nerus_api<br> b) A API é composta por 2 containers de “IDs” diferentes.<br>Pare
    os dois Containers com o comando abaixo:
    <br> docker stop [CONTAINER_ID1] [CONTAINER_ID2]<br> Utilizando o exemplo acima seria:<br> docker stop 937ebc66a2d1 f8ea7aea0c0b<br> c) Com os Containers parados basta realizar o “pull”:<br> docker-compose -f nerus-api.yml pull<br> d) Ao término da
    atualização, basta subir a API novamente:
    <br> docker-compose -f nerus-api.yml up -d<br> 7.2 Configurações e cadastros no Nérus ERP<br> 1. Habilitar o recurso Vertical Web<br> Na Configuração Geral do Sistema, ao passar pelo campo Outras Opções, na 2a tela de configurações, será exibida uma
    janela contendo a seguinte pergunta, que deve ser respondida com S:<br> Ativar Vertical Web(vendas e-commerce) > S<br> 2. Inserir um Convênio para cada marketplace<br> Conforme mencionado anteriormente, será gerado um Convênio para as vendas em marketplace.<br>    Com isso, deverá ser criado um Cartão/Convênio para cada marketplace, que coincide com o Canal de venda descrito na tabela de canais, fazendo a associação pelo campo "No. Cartão E-Commerce" na inserção do Cartão/Convênio.<br> Exemplo<br> para Americanas.com:<br>    No cadastramento desse Convênio, na pergunta "No. Cartão E-Commerce", dentro da edição do Cartão/Convênio, deverá ser informado 5, que corresponde ao número da Americanas.com na tabela de canais.<br> 3. Inserir Método de Pagamento para Vendas em site
    próprio
    <br> Para site próprio, onde o canal é igual a 1 (e-commerce), as vendas serão inseridas no Nérus como Cartão ou Duplicata, de acordo com forma utilizada pelo cliente.<br> O método de pagamento utilizado nas vendas será definido pelas variáveis do
    arquivo yml do docker, sendo:
    <br> - CODIGO_CARTAO=33 >> número do método de pagamento cartão usado na venda<br> - CODIGO_BOLETO=2 >> número do método de pagamento duplicata usado na venda<br> - CODIGO_CONVENIO=35 >> número do método de pagamento convênio usado na venda.<br> No
    exemplo acima, todas as vendas em cartão serão inseridas com o método de pagamento 33, em boleto com o método 2 e em convênio com o método 35.<br> 4. Habilitar as Lojas e Áreas de Estoque que serão integradas via Nérus O2<br> Uma vez definido quais
    lojas serão integradas nas vendas digitais - e eventualmente qual área de estoque da loja será reservada para a venda on-line - deve-se informar esses dados no cadastro de lojas.<br> Para cada loja a ser integrada, basta usar a opção "Ctrl+C-ecommerce"
    e responder Sim à pergunta se existirá integração.<br> E caso esteja sendo usada uma área de estoque, o número da área de estoque deve ser informado logo na sequência.<br> Integracao com E-Commerce > S<br> No. da Area de Estoque > ____ <br>7.3 Triggers<br>    Trigger (ou gatilho, em português) é um tipo especial de função armazenada no banco de dados que é executada sempre que há uma modificação nos dados de uma ou mais tabelas.<br> É muito utilizada para se propagar alterações em um determinado dado de
    uma tabela para outras tabelas.<br> O Nérus O2 utiliza as triggers do MySQL para monitorar alterações no cadastro dos produtos, alterações nos preços e mudanças nos estoques.<br> Ou seja, toda vez que há uma alteração nos produtos que estão integrados
    com as vendas no site próprio ou marketplaces, há uma sinalização para que essas alterações sejam propagadas para o Nérus O2.<br> Isso feito com a criação de uma "fila", que vai sendo consumida de forma automática e periódica.<br> Para a criação das
    triggers no Nérus ERP, basta acessar o módulo UTILITÁRIOS, depois Outras Informações, e finalmente Criação de Triggers no Banco de Dados.<br> Esse processo deverá ser executado sem nenhum outro usuário utilizando o sistema.<br> A própria rotina fará
    uma verificação dessa condição, e emitirá um alerta caso algum outro usuário esteja conectado.<br> Esse processo é praticamente instantâneo, e absolutamente imprescindível para o correto funcionamento do Nérus O2.<br> IMPORTANTE: para um produto ser
    considerado como integração ao Nérus O2, é indispensável que a pergunta "Inibe integração Site", dentro de Características, no Editor de Produtos, esteja marcada como "Não".<br> 7.4 Número de conexões do MySQL (max_connections)<br> A API do Nérus
    O2 faz uso de várias consultas no banco para buscar as atualizações de produtos e manter a comunicação ativa entre o Nérus ERP e o Painel do Nérus O2.<br> Ocorre que, em muitos clientes, é utilizado um número relativamente baixo de conexões no banco
    de dados MySQL (variável max_connections do MySQL). Para evitar inconsistências na busca destas informações, é necessário aumentar as conexões no MySQL - normalmente é somado 200 conexões ao número atual.<br> Exemplo:<br> se o número de conexões no
    banco estava em 100, com a instalação da API deve-se passar esse número para 300.<br> 7.5 Dados para geração de Gráficos e Relatórios via SQL<br> Essa seção descreve algumas tabelas e seus respectivos campos usados pelo Nérus ERP na integração com
    o Nérus O2.<br> O objetivo é facilitar a emissão de gráficos e relatórios por qualquer ferramenta, seja QuerySQL ou WebDesktop da Nérus, quanto qualquer ferramenta de terceiros.<br> Cadastro, Preços e Estoque<br> ⦁ Tabela prdapi: controla os produtos
    que tiveram alteração a partir das triggers; Integração de Pedidos<br> ⦁ Tabela eord (Pedidos de Clientes): <br>⦁ eord.s6: guarda o canal da venda, de acordo com a tabela de canais;<br> ⦁ eord.auxlong6: guarda o número do pedido do e-commerce ou do
    marketplace, de acordo com o que foi capturado pelo O2; <br>⦁ Tabela eordcr (Pagamento de Pedido de Clientes): <br>⦁ eordcr.bankno: guarda o número do Cartão<br> ⦁ eordcr.status: guarda o tipo de pagamento (3=Cartão, 8=Duplicata) <br>⦁ Tabela card2
    (Operadora de Cartão/Convênio): ⦁ card.s4: Número do Cartão E-Commerce dentro do cadastro do Cartão de Crédito (na prática, card2.no = eordcr.bankno) <br>7.6 Tabelas atualizadas na utilização da API<br> Ao trazer os pedidos de um canal digital de
    venda, são inseridos registros em diferentes do Nérus ERP, de tal forma que os dados possam ser gerenciados corretamente pelo sistema.<br> As tabelas que são atualizadas na inserção de pedidos de venda feitos na internet são:<br> Tabela Descrição
    Comentário custp Clientes Insere um novo cliente caso o CPF/CNPJ do cliente da venda não seja encontrado eord Pedido de Cliente Pedido propriamente dito eoprd Produtos do Pedido Produtos do pedido vendido eoprd2 Produtos do Pedido <br>- complemento
    Produtos do pedido vendido <br>- dados complementares eoprdsa Produtos do Pedido<br> - Área de Estoque Produtos do pedido vendido contemplando a área de estoque de saída da mercadoria eordrk Pedido <br>- Observações Observações do Pedido de Venda
    eordcr Pedido <br>- dados de pagamento Dados de pagamento do Pedido (venda em cartão ou Convênio, parcelamento, etc) nfr Romaneios de Entrega Toda a gestão de entrega é feita por meio de romaneios nfrprd Produtos do Romaneio de Entrega Produtos do
    Romaneio de Entrega nfm Romaneio <br>- dados de Entrega e Montagem Dados de entrega e montagem relativo ao Romaneio de Entrega nfrtrack Rastreabilidade dos romaneios Controla toda a mo vimentação e rastreabilidade dos romaneios, facilitando o gerenciamento



</body>

</html>